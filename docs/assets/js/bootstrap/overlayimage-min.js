KISSY.add("bootstrap/overlayimage",function(a,d){var c="thumbnail";function b(e){b.superclass.constructor.call(this,e);this._init()}a.extend(b,a.Base);a.augment(b,{_getLinkItems:function(){var e=this,g=e.get("el"),f=g.all("."+c);return f},_getCurrentItem:function(){var e=this;return e.get("currentItem")},_getItemIndex:function(g,f){var e=-1;f.each(function(i,h){if(i[0]===g[0]){e=h;return false}});return e},_getNextItem:function(h,f){var e=this,g=-1;h=h||e._getCurrentItem();f=f||e._getLinkItems();g=e._getItemIndex(h,f);return a.one(f[g+1])},_getPrevItem:function(h,f){var e=this,g=-1;h=h||e._getCurrentItem();f=f||e._getLinkItems();g=e._getItemIndex(h,f);return a.one(f[g-1])},_init:function(){var e=this;e._initDom();e._initEvent();e._initOverlay();e._initOverlayEvent()},_initDom:function(){var e=this,f=a.one(e.get("srcNode"));e.set("el",f)},_initEvent:function(){var e=this,g=e.get("el"),f=null;g.delegate("click","."+c,function(i){i.halt();var h=a.one(i.currentTarget);e._showItem(h)});a.Event.delegate(document,"click",".ks-ext-mask",function(){f=e.get("overlay");if(f){f.hide()}})},_initOverlay:function(){var e=this,f=new d({content:'<div class="oi-outer"><div class="oi-container"><img class="oi-img" src="http://placehold.it/500x500"/><a class="oi-prev" style="display: block; "></a><a class="oi-next" style="display: block; "></a></div><div class="oi-data"><div class="oi-title"></div><div class="oi-numer"></div></div></div>',effect:{effect:"fade",duration:0.5},align:{points:["cc","cc"]},width:500,height:500,closable:false,mask:true});e.set("overlay",f)},_initOverlayEvent:function(){var f=this,g=f.get("overlay"),j=null,h=null,e=null,i=null;g.on("afterRenderUI",function(){j=g.get("el");h=j.one(".oi-prev");e=j.one(".oi-next");i=j.one(".oi-img");h.on("click",function(l){l.halt();var k=f._getPrevItem();f._showItem(k)});e.on("click",function(l){l.halt();var k=f._getNextItem();f._showItem(k)});i.on("load",function(m){var l=i.width(),k=i.height();g.set("width",l);g.set("height",k);g.set("align",{points:["cc","cc"]})})})},_showItem:function(j){if(!j){return}var e=this,k=j.attr("href"),i=e.get("el"),f=null,h=e._getCurrentItem(),g=e.get("overlay");if(!g.get("visible")){f=i.all("."+c);e.set("linkItems",f);g.show()}if(h&&h.attr("href"===k)){return}e.set("currentItem",j);e._setImageInfo(j)},_setImageInfo:function(j){var e=this,h=e.get("overlay"),f=h.get("el"),g=j.one("img"),i=f.one(".oi-prev");nextEl=f.one(".oi-next");f.one(".oi-img").attr("src",j.attr("href"));f.one(".oi-title").text(j.attr("title"));if(g){f.one(".oi-numer").text(g.attr("alt"))}if(e._getPrevItem(j)){i.show()}else{i.hide()}if(e._getNextItem(j)){nextEl.show()}else{nextEl.hide()}},getTotalCount:function(){},getCurrentIndex:function(){},show:function(e){},hide:function(){},next:function(){},prev:function(){}});return b},{requires:["overlay"]});
